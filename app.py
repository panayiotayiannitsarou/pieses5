
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
from io import BytesIO
import random

# â¤ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎšÏ‰Î´Î¹ÎºÎ¿Ï Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚
st.sidebar.title("ğŸ” ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚")
password = st.sidebar.text_input("Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ:", type="password")
if password != "katanomi2025":
    st.warning("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ ÎºÏ‰Î´Î¹ÎºÏŒ Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.")
    st.stop()

# â¤ Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·/Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚
enable_app = st.sidebar.checkbox("âœ… Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚", value=True)
if not enable_app:
    st.info("ğŸ”’ Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·.")
    st.stop()

# â¤ Î’Î¿Î·Î¸Î·Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚
def is_mutual_friend(df, child1, child2):
    f1 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child1, 'Î¦Î™Î›Î™Î‘'].values[0])
    f2 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child2, 'Î¦Î™Î›Î™Î‘'].values[0])
    return (child2 in f1.split(",")) and (child1 in f2.split(","))

def has_conflict(df, child1, child2):
    c1 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child1, 'Î£Î¥Î“ÎšÎ¡ÎŸÎ¥Î£Î—'].values[0])
    c2 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child2, 'Î£Î¥Î“ÎšÎ¡ÎŸÎ¥Î£Î—'].values[0])
    return (child2 in c1.split(",")) or (child1 in c2.split(","))

def Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±, ÎºÎ»ÎµÎ¹Î´Ï‰Î¼Î±=True):
    df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'Î¤ÎœÎ—ÎœÎ‘'] = Ï„Î¼Î·Î¼Î±
    df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] = ÎºÎ»ÎµÎ¹Î´Ï‰Î¼Î±
    tmimata[Ï„Î¼Î·Î¼Î±].append(Î¼Î±Î¸Î·Ï„Î·Ï‚)

# â¤ Î•Î´Ï ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Î’Î·Î¼Î¬Ï„Ï‰Î½ 1â€“8 (Î±Ï€ÏŒ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î± ÏƒÏ‰ÏƒÏ„Î¬ Î±ÏÏ‡ÎµÎ¯Î±)
# Î“Î¹Î± ÏƒÏ…Î½Ï„Î¿Î¼Î¯Î±, Î¸Î± Ï„Î¹Ï‚ Ï†Î¿ÏÏ„ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î± Î±Ï€ÏŒ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î± fragments



# --- START OF FILE: d6bd581f-3531-4260-be7e-3096c48dad5d.py ---
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
from io import BytesIO
import random

# â¤ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎšÏ‰Î´Î¹ÎºÎ¿Ï Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚
st.sidebar.title("ğŸ” ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚")
password = st.sidebar.text_input("Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ:", type="password")
if password != "katanomi2025":
    st.warning("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ ÎºÏ‰Î´Î¹ÎºÏŒ Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.")
    st.stop()

# â¤ Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·/Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚
enable_app = st.sidebar.checkbox("âœ… Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚", value=True)
if not enable_app:
    st.info("ğŸ”’ Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·.")
    st.stop()

# â¤ Î’Î¿Î·Î¸Î·Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚

def is_mutual_friend(df, child1, child2):
    f1 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child1, 'Î¦Î™Î›Î™Î‘'].values[0])
    f2 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child2, 'Î¦Î™Î›Î™Î‘'].values[0])
    return (child2 in f1.split(",")) and (child1 in f2.split(","))

def has_conflict(df, child1, child2):
    c1 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child1, 'Î£Î¥Î“ÎšÎ¡ÎŸÎ¥Î£Î—'].values[0])
    c2 = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == child2, 'Î£Î¥Î“ÎšÎ¡ÎŸÎ¥Î£Î—'].values[0])
    return (child2 in c1.split(",")) or (child1 in c2.split(","))

def Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±, ÎºÎ»ÎµÎ¹Î´Ï‰Î¼Î±=True):
    df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'Î¤ÎœÎ—ÎœÎ‘'] = Ï„Î¼Î·Î¼Î±
    df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] = ÎºÎ»ÎµÎ¹Î´Ï‰Î¼Î±
    tmimata[Ï„Î¼Î·Î¼Î±].append(Î¼Î±Î¸Î·Ï„Î·Ï‚)

# â¤ Î’Î®Î¼Î± 1 â€“ Î Î±Î¹Î´Î¹Î¬ Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏÎ½

def Î²Î·Î¼Î±_1_Ï€Î±Î¹Î´Î¹Î±_ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏ‰Î½(df, tmimata):
    Ï€Î±Î¹Î´Î¹Î± = df[df['Î Î‘Î™Î”Î™ Î•ÎšÎ Î‘Î™Î”Î•Î¥Î¤Î™ÎšÎŸÎ¥'] == 'Î']
    Î¼Î·_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹ = Ï€Î±Î¹Î´Î¹Î±[~Ï€Î±Î¹Î´Î¹Î±['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'].isin(df[df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£']]['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'])]
    Î¼Î·_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹ = Î¼Î·_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹.sample(frac=1)
    Ï„Î¼Î·Î¼Î±Ï„Î± = list(tmimata.keys())
    Î´ÎµÎ¹ÎºÏ„Î·Ï‚ = 0
    for _, row in Î¼Î·_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹.iterrows():
        Î¼Î±Î¸Î·Ï„Î·Ï‚ = row['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']
        for _ in range(len(Ï„Î¼Î·Î¼Î±Ï„Î±)):
            Ï„Î¼Î·Î¼Î± = Ï„Î¼Î·Î¼Î±Ï„Î±[Î´ÎµÎ¹ÎºÏ„Î·Ï‚ % len(Ï„Î¼Î·Î¼Î±Ï„Î±)]
            Î¿Î¼Î±Î´Î± = df[df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼Î·Î¼Î±]
            if len(Î¿Î¼Î±Î´Î±) < 25 and not any(has_conflict(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, m) for m in Î¿Î¼Î±Î´Î±['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']):
                Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±)
                break
            Î´ÎµÎ¹ÎºÏ„Î·Ï‚ += 1

# â¤ Î’Î®Î¼Î± 2 â€“ Î–Ï‰Î·ÏÎ¿Î¯ ÎœÎ±Î¸Î·Ï„Î­Ï‚

def Î²Î·Î¼Î±_2_Î¶Ï‰Î·ÏÎ¿Î¹(df, tmimata):
    Î¶Ï‰Î·ÏÎ¿Î¹ = df[(df['Î–Î©Î—Î¡ÎŸÎ£'] == 'Î') & (df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == False)]
    Ï…Ï€Î±ÏÏ‡Î¿Î½Ï„ÎµÏ‚_Î¶Ï‰Î·ÏÎ¿Î¹ = df[(df['Î–Î©Î—Î¡ÎŸÎ£'] == 'Î') & (df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == True)]
    ÏƒÏ…Î½Î¿Î»Î¿ = len(Î¶Ï‰Î·ÏÎ¿Î¹) + len(Ï…Ï€Î±ÏÏ‡Î¿Î½Ï„ÎµÏ‚_Î¶Ï‰Î·ÏÎ¿Î¹)
    Ï„Î¼Î·Î¼Î±Ï„Î± = list(tmimata.keys())
    ÎºÎ±Ï„Î±Î½Î¿Î¼Î· = {t: len(df[(df['Î¤ÎœÎ—ÎœÎ‘'] == t) & (df['Î–Î©Î—Î¡ÎŸÎ£'] == 'Î')]) for t in Ï„Î¼Î·Î¼Î±Ï„Î±}

    for _, row in Î¶Ï‰Î·ÏÎ¿Î¹.iterrows():
        Î¼Î±Î¸Î·Ï„Î·Ï‚ = row['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']
        Ï„Î¼Î·Î¼Î±Ï„Î±_sorted = sorted(Ï„Î¼Î·Î¼Î±Ï„Î±, key=lambda t: ÎºÎ±Ï„Î±Î½Î¿Î¼Î·[t])
        for Ï„Î¼Î·Î¼Î± in Ï„Î¼Î·Î¼Î±Ï„Î±_sorted:
            Î¿Î¼Î±Î´Î± = df[df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼Î·Î¼Î±]
            if len(Î¿Î¼Î±Î´Î±) < 25 and ÎºÎ±Ï„Î±Î½Î¿Î¼Î·[Ï„Î¼Î·Î¼Î±] < (ÏƒÏ…Î½Î¿Î»Î¿ + len(Ï„Î¼Î·Î¼Î±Ï„Î±) - 1) // len(Ï„Î¼Î·Î¼Î±Ï„Î±):
                Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ· = any(has_conflict(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, m) for m in Î¿Î¼Î±Î´Î±['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'])
                if not Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ·:
                    Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±)
                    ÎºÎ±Ï„Î±Î½Î¿Î¼Î·[Ï„Î¼Î·Î¼Î±] += 1
                    break

# â¤ Î’Î®Î¼Î± 3 â€“ Î Î±Î¹Î´Î¹Î¬ Î¼Îµ Î™Î´Î¹Î±Î¹Ï„ÎµÏÏŒÏ„Î·Ï„ÎµÏ‚

def Î²Î·Î¼Î±_3_Î¹Î´Î¹Î±Î¹Ï„ÎµÏÎ¿Ï„Î·Ï„ÎµÏ‚(df, tmimata):
    Ï€Î±Î¹Î´Î¹Î± = df[(df['Î™Î”Î™Î‘Î™Î¤Î•Î¡ÎŸÎ¤Î—Î¤Î‘'] == 'Î') & (df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == False)]
    Ï„Î¼Î·Î¼Î±Ï„Î± = list(tmimata.keys())
    ÎºÎ±Ï„Î±Î½Î¿Î¼Î· = {t: len(df[(df['Î¤ÎœÎ—ÎœÎ‘'] == t) & (df['Î™Î”Î™Î‘Î™Î¤Î•Î¡ÎŸÎ¤Î—Î¤Î‘'] == 'Î')]) for t in Ï„Î¼Î·Î¼Î±Ï„Î±}
    for _, row in Ï€Î±Î¹Î´Î¹Î±.iterrows():
        Î¼Î±Î¸Î·Ï„Î·Ï‚ = row['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']
        Ï„Î¼Î·Î¼Î±Ï„Î±_sorted = sorted(Ï„Î¼Î·Î¼Î±Ï„Î±, key=lambda t: (ÎºÎ±Ï„Î±Î½Î¿Î¼Î·[t], len(tmimata[t])))
        for Ï„Î¼Î·Î¼Î± in Ï„Î¼Î·Î¼Î±Ï„Î±_sorted:
            Î¿Î¼Î±Î´Î± = df[df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼Î·Î¼Î±]
            if len(Î¿Î¼Î±Î´Î±) < 25 and not any(has_conflict(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, m) for m in Î¿Î¼Î±Î´Î±['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']):
                Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±)
                ÎºÎ±Ï„Î±Î½Î¿Î¼Î·[Ï„Î¼Î·Î¼Î±] += 1
                break

# â¤ Î’Î®Î¼Î± 4 â€“ Î¦Î¯Î»Î¿Î¹ Î Î±Î¹Î´Î¹ÏÎ½ Î’Î·Î¼Î¬Ï„Ï‰Î½ 1â€“3

def Î²Î·Î¼Î±_4_Ï†Î¹Î»Î¿Î¹_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Ï‰Î½(df, tmimata):
    Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹ = df[df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == True]['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'].tolist()
    Ï†Î¹Î»Î¿Î¹ = df[df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == False]
    for _, row in Ï†Î¹Î»Î¿Î¹.iterrows():
        Î¼Î±Î¸Î·Ï„Î·Ï‚ = row['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ']
        Ï†Î¹Î»Î¿Î¹_Ï„Î¿Ï… = str(row['Î¦Î™Î›Î™Î‘']).split(',')
        for Ï† in Ï†Î¹Î»Î¿Î¹_Ï„Î¿Ï…:
            Ï† = Ï†.strip()
            if Ï† in Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Î¿Î¹ and is_mutual_friend(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï†):
                Ï„Î¼Î·Î¼Î±_Ï† = df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Ï†, 'Î¤ÎœÎ—ÎœÎ‘'].values[0]
                if len(tmimata[Ï„Î¼Î·Î¼Î±_Ï†]) < 25 and not any(has_conflict(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, m) for m in tmimata[Ï„Î¼Î·Î¼Î±_Ï†]):
                    Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï„Î¼Î·Î¼Î±_Ï†)
                    break

# â¤ Î’Î®Î¼Î± 5 â€“ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î Î¿Î¹Î¿Ï„Î¹ÎºÏÎ½ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏÎ½

def Î²Î·Î¼Î±_5_ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ±_Î±Î½Î±_Ï„Î¼Î·Î¼Î±(df):
    ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ± = {}
    for Ï„Î¼Î·Î¼Î± in df['Î¤ÎœÎ—ÎœÎ‘'].dropna().unique():
        Î¿Î¼Î±Î´Î± = df[df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼Î·Î¼Î±]
        ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ±[Ï„Î¼Î·Î¼Î±] = {
            'Î£ÏÎ½Î¿Î»Î¿': len(Î¿Î¼Î±Î´Î±),
            'Î‘Î³ÏŒÏÎ¹Î±': len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['Î¦Î¥Î›ÎŸ'] == 'Î‘']),
            'ÎšÎ¿ÏÎ¯Ï„ÏƒÎ¹Î±': len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['Î¦Î¥Î›ÎŸ'] == 'Îš']),
            'ÎšÎ±Î»Î® Î“Î½ÏÏƒÎ·': len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'] == 'Î']),
            'ÎœÎ±Î¸Î·ÏƒÎ¹Î±ÎºÎ® Î™ÎºÎ±Î½ÏŒÏ„Î·Ï„Î±': len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘'] == 'Î'])
        }
    return ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ±

# â¤ Î Î»Î®ÏÎ·Ï‚ ÎšÎ±Ï„Î±Î½Î¿Î¼Î® (Î’Î®Î¼Î±Ï„Î± 1â€“5)

def Ï€Î»Î·ÏÎ·Ï‚_ÎºÎ±Ï„Î±Î½Î¿Î¼Î·(df):
    df['Î¤ÎœÎ—ÎœÎ‘'] = None
    df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] = False
    max_per_class = 25
    num_students = len(df)
    num_classes = (num_students + max_per_class - 1) // max_per_class
    tmimata = {f'Î¤Î¼Î®Î¼Î± {i+1}': [] for i in range(num_classes)}
    Î²Î·Î¼Î±_1_Ï€Î±Î¹Î´Î¹Î±_ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏ‰Î½(df, tmimata)
    Î²Î·Î¼Î±_2_Î¶Ï‰Î·ÏÎ¿Î¹(df, tmimata)
    Î²Î·Î¼Î±_3_Î¹Î´Î¹Î±Î¹Ï„ÎµÏÎ¿Ï„Î·Ï„ÎµÏ‚(df, tmimata)
    Î²Î·Î¼Î±_4_Ï†Î¹Î»Î¿Î¹_Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼ÎµÎ½Ï‰Î½(df, tmimata)
    ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ± = Î²Î·Î¼Î±_5_ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ±_Î±Î½Î±_Ï„Î¼Î·Î¼Î±(df)
    return df, tmimata, ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ±

# --- END OF FILE: d6bd581f-3531-4260-be7e-3096c48dad5d.py ---

# --- START OF FILE: 9bdfce57-8af9-4966-954e-2fe989495f58.py ---

# â¤ Î’Î®Î¼Î± 6 â€“ Î¦Î¹Î»Î¹ÎºÎ­Ï‚ ÎŸÎ¼Î¬Î´ÎµÏ‚ Î±Î½Î¬ Î“Î½ÏÏƒÎ· Î•Î»Î»Î·Î½Î¹ÎºÏÎ½
def Î²Î·Î¼Î±_6_Ï†Î¹Î»Î¹ÎºÎµÏ‚_Î¿Î¼Î±Î´ÎµÏ‚_Î³Î»Ï‰ÏƒÏƒÎ¹ÎºÎ±(df, tmimata):
    Ï…Ï€Î¿Î»Î¿Î¹Ï€Î¿Î¹ = df[(df['Î¤ÎœÎ—ÎœÎ‘'].isna()) & (df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == False)]
    Î¿Î½Î¿Î¼Î±Ï„Î± = Ï…Ï€Î¿Î»Î¿Î¹Ï€Î¿Î¹['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'].tolist()
    Ï†Î¹Î»Î¹ÎµÏ‚ = []
    for i in range(len(Î¿Î½Î¿Î¼Î±Ï„Î±)):
        for j in range(i + 1, len(Î¿Î½Î¿Î¼Î±Ï„Î±)):
            a, b = Î¿Î½Î¿Î¼Î±Ï„Î±[i], Î¿Î½Î¿Î¼Î±Ï„Î±[j]
            if is_mutual_friend(df, a, b) and not has_conflict(df, a, b):
                Ï†Î¹Î»Î¹ÎµÏ‚.append({a, b})
    Î¿Î¼Î¬Î´ÎµÏ‚ = []
    while Ï†Î¹Î»Î¹ÎµÏ‚:
        Î¿Î¼Î¬Î´Î± = Ï†Î¹Î»Î¹ÎµÏ‚.pop(0)
        ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÎ¸Î·ÎºÎµ = False
        for i, Ï…Ï€ in enumerate(Ï†Î¹Î»Î¹ÎµÏ‚):
            if Î¿Î¼Î¬Î´Î± & Ï…Ï€:
                Î½Î­Î±_Î¿Î¼Î¬Î´Î± = Î¿Î¼Î¬Î´Î± | Ï…Ï€
                if len(Î½Î­Î±_Î¿Î¼Î¬Î´Î±) <= 3:
                    Î¿Î¼Î¬Î´ÎµÏ‚.append(list(Î½Î­Î±_Î¿Î¼Î¬Î´Î±))
                    Ï†Î¹Î»Î¹ÎµÏ‚.pop(i)
                    ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÎ¸Î·ÎºÎµ = True
                    break
        if not ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÎ¸Î·ÎºÎµ:
            Î¿Î¼Î¬Î´ÎµÏ‚.append(list(Î¿Î¼Î¬Î´Î±))
    ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÎµÏ‚ = {'ÎºÎ±Î»Î·': [], 'Î¿Ï‡Î¹': [], 'Î¼Î¹ÎºÏ„Î·': []}
    for Î¿Î¼Î¬Î´Î± in Î¿Î¼Î¬Î´ÎµÏ‚:
        Î³Î½Ï‰ÏƒÎµÎ¹Ï‚ = [df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == m, 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'].values[0] for m in Î¿Î¼Î¬Î´Î±]
        if all(g == 'Î' for g in Î³Î½Ï‰ÏƒÎµÎ¹Ï‚):
            ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÎµÏ‚['ÎºÎ±Î»Î·'].append(Î¿Î¼Î¬Î´Î±)
        elif all(g == 'ÎŸ' for g in Î³Î½Ï‰ÏƒÎµÎ¹Ï‚):
            ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÎµÏ‚['Î¿Ï‡Î¹'].append(Î¿Î¼Î¬Î´Î±)
        else:
            ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÎµÏ‚['Î¼Î¹ÎºÏ„Î·'].append(Î¿Î¼Î¬Î´Î±)
    for ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹Î± in ['Î¿Ï‡Î¹', 'ÎºÎ±Î»Î·', 'Î¼Î¹ÎºÏ„Î·']:
        for Î¿Î¼Î¬Î´Î± in ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÎµÏ‚[ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹Î±]:
            ÎºÎ±Ï„Î±Î»Î»Î·Î»Î± = []
            for Ï„Î¼Î·Î¼Î± in tmimata:
                Î±Î½_Ï‡Ï‰ÏÎ± = len(tmimata[Ï„Î¼Î·Î¼Î±]) + len(Î¿Î¼Î¬Î´Î±) <= 25
                Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ· = any(has_conflict(df, m, a) for m in Î¿Î¼Î¬Î´Î± for a in tmimata[Ï„Î¼Î·Î¼Î±])
                if Î±Î½_Ï‡Ï‰ÏÎ± and not Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ·:
                    ÎºÎ±Ï„Î±Î»Î»Î·Î»Î±.append(Ï„Î¼Î·Î¼Î±)
            if ÎºÎ±Ï„Î±Î»Î»Î·Î»Î±:
                ÎµÏ€Î¹Î»Î¿Î³Î· = min(ÎºÎ±Ï„Î±Î»Î»Î·Î»Î±, key=lambda t: abs(
                    sum(df.loc[df['Î¤ÎœÎ—ÎœÎ‘'] == t, 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'] == 'Î') -
                    sum(df.loc[df['Î¤ÎœÎ—ÎœÎ‘'] == t, 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'] == 'ÎŸ')
                ))
                for Î¼Î±Î¸Î·Ï„Î·Ï‚ in Î¿Î¼Î¬Î´Î±:
                    Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, ÎµÏ€Î¹Î»Î¿Î³Î·)

# â¤ Î’Î®Î¼Î± 7 â€“ Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿Î¹ ÎœÎ±Î¸Î·Ï„Î­Ï‚ Î§Ï‰ÏÎ¯Ï‚ Î¦Î¹Î»Î¯ÎµÏ‚
def Î²Î·Î¼Î±_7_Ï‡Ï‰ÏÎ¹Ï‚_Ï†Î¹Î»Î¿Ï…Ï‚(df, tmimata):
    Ï…Ï€Î¿ÏˆÎ·Ï†Î¹Î¿Î¹ = df[(df['Î¤ÎœÎ—ÎœÎ‘'].isna()) & (df['ÎšÎ›Î•Î™Î”Î©ÎœÎ•ÎÎŸÎ£'] == False)].copy()
    def ÎµÏ‡ÎµÎ¹_Î±Î¼Î¿Î¹Î²Î±Î¹Î±_Ï†Î¹Î»Î¹Î±(Î¼Î±Î¸Î·Ï„Î·Ï‚):
        Ï†Î¹Î»Î¿Î¹ = str(df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'Î¦Î™Î›Î™Î‘'].values[0]).split(',')
        Ï†Î¹Î»Î¿Î¹ = [f.strip() for f in Ï†Î¹Î»Î¿Î¹ if f.strip()]
        for Ï† in Ï†Î¹Î»Î¿Î¹:
            if Ï† in df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'].values and is_mutual_friend(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, Ï†):
                if df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Ï†, 'Î¤ÎœÎ—ÎœÎ‘'].isna().values[0]:
                    return True
        return False
    Ï‡Ï‰ÏÎ¹Ï‚_Ï†Î¹Î»Î¿Ï…Ï‚ = [m for m in Ï…Ï€Î¿ÏˆÎ·Ï†Î¹Î¿Î¹['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] if not ÎµÏ‡ÎµÎ¹_Î±Î¼Î¿Î¹Î²Î±Î¹Î±_Ï†Î¹Î»Î¹Î±(m)]
    for Î¼Î±Î¸Î·Ï„Î·Ï‚ in Ï‡Ï‰ÏÎ¹Ï‚_Ï†Î¹Î»Î¿Ï…Ï‚:
        ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_Ï„Î¼Î·Î¼Î± = None
        ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_score = float('inf')
        for Ï„Î¼Î·Î¼Î± in tmimata:
            Î±Î½_Ï‡Ï‰ÏÎ± = len(tmimata[Ï„Î¼Î·Î¼Î±]) < 25
            Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ· = any(has_conflict(df, Î¼Î±Î¸Î·Ï„Î·Ï‚, m) for m in tmimata[Ï„Î¼Î·Î¼Î±])
            if not Î±Î½_Ï‡Ï‰ÏÎ± or Î±Î½_ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏƒÎ·:
                continue
            Î¿Î¼Î±Î´Î± = df[df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼Î·Î¼Î±]
            Ï†Ï…Î»Î¿ = df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'Î¦Î¥Î›ÎŸ'].values[0]
            ÎµÎ»Î»Î·Î½Î¹ÎºÎ± = df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'].values[0]
            Î¼Î±Î¸Î·ÏƒÎ¹Î±ÎºÎ· = df.loc[df['ÎŸÎÎŸÎœÎ‘Î¤Î•Î Î©ÎÎ¥ÎœÎŸ'] == Î¼Î±Î¸Î·Ï„Î·Ï‚, 'Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘'].values[0]
            count_Ï†Ï…Î»Î¿ = len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['Î¦Î¥Î›ÎŸ'] == Ï†Ï…Î»Î¿])
            count_ÎµÎ»Î»Î·Î½Î¹ÎºÎ± = len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î'] == ÎµÎ»Î»Î·Î½Î¹ÎºÎ±])
            count_Î¼Î±Î¸Î·ÏƒÎ¹Î±ÎºÎ· = len(Î¿Î¼Î±Î´Î±[Î¿Î¼Î±Î´Î±['Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘'] == Î¼Î±Î¸Î·ÏƒÎ¹Î±ÎºÎ·])
            score = count_Ï†Ï…Î»Î¿ + count_ÎµÎ»Î»Î·Î½Î¹ÎºÎ± + count_Î¼Î±Î¸Î·ÏƒÎ¹Î±ÎºÎ·
            if score < ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_score:
                ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_score = score
                ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_Ï„Î¼Î·Î¼Î± = Ï„Î¼Î·Î¼Î±
        if ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_Ï„Î¼Î·Î¼Î±:
            Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·ÏƒÎ·(df, tmimata, Î¼Î±Î¸Î·Ï„Î·Ï‚, ÎºÎ±Î»Ï…Ï„ÎµÏÎ¿_Ï„Î¼Î·Î¼Î±)

# â¤ Î’Î®Î¼Î± 8 â€“ Î¤ÎµÎ»Î¹ÎºÏŒÏ‚ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î‘Ï€Î¿ÎºÎ»Î¯ÏƒÎµÏ‰Î½
def Î²Î·Î¼Î±_8_Ï„ÎµÎ»Î¹ÎºÎ¿Ï‚_ÎµÎ»ÎµÎ³Ï‡Î¿Ï‚(df, tmimata):
    Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ = ['Î¦Î¥Î›ÎŸ', 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î', 'Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘']
    max_diff = 3
    Ï„Î¼Î·Î¼Î±Ï„Î± = list(tmimata.keys())
    Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚ = []
    for x in Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:
        Î¼Î¿Î½Î±Î´Î¹ÎºÎµÏ‚ = df[x].dropna().unique()
        for Ï„Î¹Î¼Î® in Î¼Î¿Î½Î±Î´Î¹ÎºÎµÏ‚:
            for i in range(len(Ï„Î¼Î·Î¼Î±Ï„Î±)):
                for j in range(i + 1, len(Ï„Î¼Î·Î¼Î±Ï„Î±)):
                    Ï„Î¼1, Ï„Î¼2 = Ï„Î¼Î·Î¼Î±Ï„Î±[i], Ï„Î¼Î·Î¼Î±Ï„Î±[j]
                    count1 = len(df[(df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼1) & (df[x] == Ï„Î¹Î¼Î®)])
                    count2 = len(df[(df['Î¤ÎœÎ—ÎœÎ‘'] == Ï„Î¼2) & (df[x] == Ï„Î¹Î¼Î®)])
                    diff = abs(count1 - count2)
                    if diff > max_diff:
                        Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚.append(f"âš ï¸ Î‘Ï€ÏŒÎºÎ»Î¹ÏƒÎ· {diff} Î³Î¹Î± '{x} = {Ï„Î¹Î¼Î®}' Î¼ÎµÏ„Î±Î¾Ï {Ï„Î¼1} ÎºÎ±Î¹ {Ï„Î¼2}")
    return Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚

# --- END OF FILE: 9bdfce57-8af9-4966-954e-2fe989495f58.py ---

# â¤ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… Excel Î³Î¹Î± export
def create_excel_file(df):
    output = BytesIO()
    with pd.ExcelWriter(output, engine='xlsxwriter') as writer:
        df.to_excel(writer, index=False, sheet_name='ÎšÎ±Ï„Î±Î½Î¿Î¼Î®')
    return output.getvalue()

# â¤ Î¡Î±Î²Î´Î¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î±
def plot_distribution(df, column, title):
    fig, ax = plt.subplots()
    df.groupby(['Î¤ÎœÎ—ÎœÎ‘', column]).size().unstack(fill_value=0).plot(kind='bar', stacked=True, ax=ax)
    ax.set_title(title)
    ax.set_ylabel('Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÎœÎ±Î¸Î·Ï„ÏÎ½')
    st.pyplot(fig)

# â¤ Î•Ï†Î±ÏÎ¼Î¿Î³Î® Streamlit
st.title("ğŸ“˜ Î¨Î·Ï†Î¹Î±ÎºÎ® ÎšÎ±Ï„Î±Î½Î¿Î¼Î® ÎœÎ±Î¸Î·Ï„ÏÎ½ Î‘' Î”Î·Î¼Î¿Ï„Î¹ÎºÎ¿Ï")

uploaded_file = st.file_uploader("ğŸ”¹ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Excel Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î¼Î±Î¸Î·Ï„ÏÎ½", type="xlsx")

if uploaded_file:
    df = pd.read_excel(uploaded_file)
    st.success("âœ… Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!")

    if st.button("ğŸ”¹ Î•ÎºÏ„Î­Î»ÎµÏƒÎ· ÎšÎ±Ï„Î±Î½Î¿Î¼Î®Ï‚ ÎœÎ±Î¸Î·Ï„ÏÎ½"):
        df, tmimata, stats, Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚ = Ï€Î»Î·ÏÎ·Ï‚_ÎºÎ±Ï„Î±Î½Î¿Î¼Î·_v2(df)
        st.session_state["df_katanomi"] = df
        st.success("âœ… ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ Î· ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Î¼Î±Î¸Î·Ï„ÏÎ½.")
        if Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚:
            st.warning("âš ï¸ Î•Î½Ï„Î¿Ï€Î¯ÏƒÏ„Î·ÎºÎ±Î½ Î±Ï€Î¿ÎºÎ»Î¯ÏƒÎµÎ¹Ï‚:")
            for a in Î±Ï€Î¿ÎºÎ»Î¹ÏƒÎµÎ¹Ï‚:
                st.markdown(f"- {a}")

if "df_katanomi" in st.session_state:
    df = st.session_state["df_katanomi"]

    if st.button("ğŸ”¹ Î›Î®ÏˆÎ· Excel Î¼Îµ ÎšÎ±Ï„Î±Î½Î¿Î¼Î®"):
        excel_bytes = create_excel_file(df)
        st.download_button("ğŸ“¥ ÎšÎ±Ï„Î­Î²Î±ÏƒÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Excel", data=excel_bytes, file_name="katanomi.xlsx", mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")

    st.subheader("ğŸ“Š Î Î¯Î½Î±ÎºÎ±Ï‚ Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÏÎ½ ÎšÎ±Ï„Î±Î½Î¿Î¼Î®Ï‚")
    st.dataframe(df.groupby('Î¤ÎœÎ—ÎœÎ‘')[['Î¦Î¥Î›ÎŸ', 'Î–Î©Î—Î¡ÎŸÎ£', 'Î™Î”Î™Î‘Î™Î¤Î•Î¡ÎŸÎ¤Î—Î¤Î‘', 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î', 'Î Î‘Î™Î”Î™ Î•ÎšÎ Î‘Î™Î”Î•Î¥Î¤Î™ÎšÎŸÎ¥', 'Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘']].agg(lambda x: (x == 'Î').sum()))

    st.subheader("ğŸ“Š Î¡Î±Î²Î´Î¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î± ÎšÎ±Ï„Î±Î½Î¿Î¼Î®Ï‚")
    ÎµÏ€Î¹Î»Î¿Î³Î· = st.radio("Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï„ÏÏ€Î¿ Î³ÏÎ±Ï†Î®Î¼Î±Ï„Î¿Ï‚:", ["Î£Ï…Î³ÎºÎµÎ½Ï„ÏÏ‰Ï„Î¹ÎºÏŒ", "ÎÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î±Î½Î¬ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±"])
    if ÎµÏ€Î¹Î»Î¿Î³Î· == "Î£Ï…Î³ÎºÎµÎ½Ï„ÏÏ‰Ï„Î¹ÎºÏŒ":
        plot_distribution(df, 'Î¦Î¥Î›ÎŸ', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î¦ÏÎ»Î¿Ï…")
        plot_distribution(df, 'Î–Î©Î—Î¡ÎŸÎ£', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î–Ï‰Î·ÏÏÎ½ ÎœÎ±Î¸Î·Ï„ÏÎ½")
        plot_distribution(df, 'Î™Î”Î™Î‘Î™Î¤Î•Î¡ÎŸÎ¤Î—Î¤Î‘', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î™Î´Î¹Î±Î¹Ï„ÎµÏÎ¿Ï„Î®Ï„Ï‰Î½")
        plot_distribution(df, 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î“Î½ÏÏƒÎ·Ï‚ Î•Î»Î»Î·Î½Î¹ÎºÏÎ½")
        plot_distribution(df, 'Î Î‘Î™Î”Î™ Î•ÎšÎ Î‘Î™Î”Î•Î¥Î¤Î™ÎšÎŸÎ¥', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î Î±Î¹Î´Î¹ÏÎ½ Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏÎ½")
        plot_distribution(df, 'Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘', "ÎšÎ±Ï„Î±Î½Î¿Î¼Î® ÎœÎ±Î¸Î·ÏƒÎ¹Î±ÎºÎ®Ï‚ Î™ÎºÎ±Î½ÏŒÏ„Î·Ï„Î±Ï‚")
    else:
        for col in ['Î¦Î¥Î›ÎŸ', 'Î–Î©Î—Î¡ÎŸÎ£', 'Î™Î”Î™Î‘Î™Î¤Î•Î¡ÎŸÎ¤Î—Î¤Î‘', 'ÎšÎ‘Î›Î— Î“ÎÎ©Î£Î— Î•Î›Î›Î—ÎÎ™ÎšÎ©Î', 'Î Î‘Î™Î”Î™ Î•ÎšÎ Î‘Î™Î”Î•Î¥Î¤Î™ÎšÎŸÎ¥', 'Î™ÎšÎ‘ÎÎŸÎ ÎŸÎ™Î—Î¤Î™ÎšÎ— ÎœÎ‘Î˜Î—Î£Î™Î‘ÎšÎ— Î™ÎšÎ‘ÎÎŸÎ¤Î—Î¤Î‘']:
            plot_distribution(df, col, f"ÎšÎ±Ï„Î±Î½Î¿Î¼Î® Î²Î¬ÏƒÎµÎ¹ {col}")

# â¤ Î”Î®Î»Ï‰ÏƒÎ· Î Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÏÎ½ Î”Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½
st.markdown("---")
st.markdown(
    "ğŸ“ **ÎÎ¿Î¼Î¹ÎºÎ® Î”Î®Î»Ï‰ÏƒÎ·**: Î— Ï‡ÏÎ®ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ Î¼Îµ ÏÎ·Ï„Î® Î³ÏÎ±Ï€Ï„Î® Î¬Î´ÎµÎ¹Î± Ï„Î·Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿Ï, Î Î±Î½Î±Î³Î¹ÏÏ„Î±Ï‚ Î“Î¹Î±Î½Î½Î¯Ï„ÏƒÎ±ÏÎ¿Ï…. "
    "ÎŒÎ»Î± Ï„Î± Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÎ¬ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÏ„Î· Î“Î¹Î±Î½Î½Î¯Ï„ÏƒÎ±ÏÎ¿Ï… Î Î±Î½Î±Î³Î¹ÏÏ„Î±. Î“Î¹Î± Î¬Î´ÎµÎ¹Î± Ï‡ÏÎ®ÏƒÎ·Ï‚: "
    "[yiannitsaroupanayiota.katanomi@gmail.com](mailto:yiannitsaroupanayiota.katanomi@gmail.com)"
)
